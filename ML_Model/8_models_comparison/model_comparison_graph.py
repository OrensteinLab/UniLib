import numpy as np
import matplotlib.pyplot as plt

min_readtot=  [8109, 5599, 4193, 3241, 2533, 1983, 1537, 1176, 873, 621, 414, 239, 91, 2]
amount_of_data_points= [10000, 20000, 30000, 40000, 50000, 60000, 70000, 80000, 90000, 100000, 110000, 120000, 130000, 140000]

x_labels = [f"{amount}\n({min_read}) " for amount, min_read in zip(amount_of_data_points, min_readtot)]

#pearson corr
pc_bins_116_weights = [0.4667114115901132, 0.4597393872211084, 0.44975266710238926, 0.45695164780846353, 0.45744616774570007, 0.43565095346374, 0.4207542938616237, 0.39163527340924686, 0.3674423263839545, 0.3189995972761393, 0.2524743422933457, 0.1564525833398212, 0.12594593094611217, 0.05850129157940591]
pc_bins_116 = [0.46271869574550106, 0.4659520354909708, 0.4602449586530496, 0.4526928159486867, 0.4600285292285748, 0.4286765495880409, 0.42181144391030984, 0.38562119127361716, 0.3322540305303885, 0.2994480861063926, 0.26846048571933084, 0.1656665726414992, 0.1056999127601703, 0.13095125958361797]
pc_bins_101_weights= [0.4604252423755383, 0.450651189562, 0.45958516832438845, 0.43904873327780675, 0.42576910818022307, 0.41768542991324586, 0.39569744992487815, 0.390215808557403, 0.3606764252345447, 0.31597332158615615, 0.2910293193038379, 0.2100387686852636, 0.11549529790513932, 0.13241942756899958]
pc_bins_101= [0.4623395511985411, 0.45261288761526264, 0.44476993188667724, 0.4453126355149043, 0.43381278473559576, 0.43669392978438826, 0.415039300439297, 0.39249017161743227, 0.3690391726206309, 0.32190036102081054, 0.25853139703131417, 0.1968545762935772, 0.10445128220330746, 0.08022858486894842]
pc_meanfl_116 = [0.46540768209306616, 0.4568616378117214, 0.45173585826227736, 0.43317307895639845, 0.43305611229752705, 0.42069927923331624, 0.391161531133151, 0.368422032850866, 0.3561498681165882, 0.2949227122897714, 0.23507170727124754, 0.19411307586855092, 0.15983234042789873, 0.14058631511932002]
pc_meanfl_116_weights =  [0.4606744214394284, 0.45181494617077506, 0.46397746915221694, 0.4473494227646839, 0.43572054664428134, 0.42131807312987773, 0.3974166218403856, 0.3664431407581754, 0.3435019517164695, 0.31518573285883733, 0.2651565296077255, 0.20926463775142598, 0.17146752783754293, 0.16238594249261318]
pc_meanfl_101_weights= [0.46107934146014884, 0.46909534921905566, 0.4443069813115354, 0.4272010293863833, 0.4187972074524342, 0.410445596013134, 0.4096804809628385, 0.36679513538867337, 0.35176307964460835, 0.3251387853933709, 0.2988687573721671, 0.23737680114906132, 0.20435070386858056, 0.1747777214618721]
pc_meanfl_101=  [0.4597938507336168, 0.46177525414595066, 0.44246709239179083, 0.43283524665653694, 0.4238988664358011, 0.42229564547086607, 0.39600664884542525, 0.3707660540099166, 0.3484141764960336, 0.31567006298186495, 0.2664847143818682, 0.22221171368370526, 0.1430432478541996, 0.13373549384814198]

fig= plt.figure(figsize=(16, 12))
fig.subplots_adjust(top=0.95, left=0.17, right=0.9, bottom=0.19)

# Plot the lines with different colors
plt.plot(amount_of_data_points, pc_meanfl_116_weights, 'g.-', label="Mean FL, 116bp sequence, with sample weights model fit")
plt.plot(amount_of_data_points, pc_meanfl_116, 'b.-', label="Mean FL, 116bp sequence")
plt.plot(amount_of_data_points, pc_meanfl_101_weights, 'r.-', label="Mean FL, 101bp sequence, with sample weights model fit")
plt.plot(amount_of_data_points, pc_meanfl_101, 'c.-', label="Mean FL, 101bp sequence")
plt.plot(amount_of_data_points, pc_bins_116_weights, 'y.-', label="4 bins, 116bp sequence, with sample weights model fit")
plt.plot(amount_of_data_points, pc_bins_116, 'm.-', label="4 bins, 116bp sequence")
plt.plot(amount_of_data_points, pc_bins_101_weights, 'k.-', label="4 bins, 101bp sequence, with sample weights model fit")
plt.plot(amount_of_data_points, pc_bins_101, 'orange', label="4 bins, 101bp sequence")

plt.xticks(np.array(amount_of_data_points)+2000, x_labels, fontsize=18, rotation=45, ha='right')
plt.yticks(np.arange(0.1, 0.55, step=0.05), fontsize=20)
plt.xlabel("#Variants in the training set \n (Total read cut-off)", fontsize=24)
plt.ylabel("Pearson correlation", fontsize=24)

# Set legend with custom placement and font size
legend = plt.legend(loc='lower left', fontsize=18.5)
legend.get_frame().set_facecolor('white')

plt.savefig('figure_3b.png', dpi=300)
plt.show()



